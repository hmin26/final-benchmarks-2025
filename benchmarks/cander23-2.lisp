(define (mix2 x y u v)
  (+ (* x y) (* u v)))

(define (mat2-mul a00 a01 a10 a11 b00 b01 b10 b11)
  (let ((c00 (mix2 a00 b00 a01 b10)))
    (let ((c01 (mix2 a00 b01 a01 b11)))
      (let ((c10 (mix2 a10 b00 a11 b10)))
        (let ((c11 (mix2 a10 b01 a11 b11)))
          (pair c00 (pair c01 (pair c10 c11))))))))

(define (trace-of-square a00 a01 a10 a11)
  (let ((prod (mat2-mul a00 a01 a10 a11 a00 a01 a10 a11)))
    (let ((c00 (left prod)))
      (let ((rest1 (right prod)))
        (let ((c11 (right (right rest1))))
          (+ c00 c11))))))

(let ((a00 1))
  (let ((a01 2))
    (let ((a10 3))
      (let ((a11 4))
        (let ((trace (trace-of-square a00 a01 a10 a11)))
          (let ((prod (mat2-mul a00 a01 a10 a11 4 3 2 1)))
            (let ((c00 (left prod)))
              (let ((c01 (left (right prod))))
                (let ((c10 (left (right (right prod)))))
                  (let ((c11 (right (right (right prod)))))
                    (print (+ trace (+ c00 (+ c01 (+ c10 c11)))))))))))))))

